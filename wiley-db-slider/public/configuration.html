<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="stylesheets/config.css">
    <script src="javascripts/angular.min.js"></script>
    <script>
        var b, i = -1;

        angular.module('app', [])
                .controller('sliderCntl', ['$scope', function ($scope) {

                    $scope.counter = i;
                    $scope.formData = {};
                    $scope.formData.slides = [];

                    //jive.tile.onOpen(function (config, options) {

                    //это удалить а следующее раскомитить
                    var config = {};
                    config["data"] = {};
                    config['data']['imageUrl'] = "url-image";
                    config["data"]["title"] = "Some title";
                    config["data"]["subtitle"] = "Very very long long long subtitle";
                    config["data"]["titleUrl"] = "url-title";


//                        // make sure config has default value
//                        if (config === null) config = {};
//
//                        // set default velue
//                        if (!config["data"]) {
//                            config['data']['imageUrl'] = "url-image";
//                            config["data"]["title"] = "Some title";
//                            config["data"]["subtitle"] = "Very very long long long subtitle";
//                            config["data"]["titleUrl"] = "url-title";
//                        }

                    //save to view.html
                    $scope.default = config["data"];

                    $scope.sendForm = function (data) {
                        config['data'] = data;
                        console.log(data);
//                        config['data']['imageUrl'] = data.imageUrl;
//                        config["data"]["title"] = data.title;
//                        config["data"]["subtitle"] = data.subtitle;
//                        config["data"]["titleUrl"] = data.titleUrl;

                        //jive.tile.close(config, {});
                    };


                    $scope.addOne = function () {
                        i++;
                        var a = {
                            //imageUrl: config['data']['imageUrl']
                        };
                        $scope.formData.slides.unshift(a);

                        b = $scope.formData.slides;
                        console.log($scope.formData.slides)
                    };

                    $scope.deleteSlide = function (e) {
                        console.log(e);
                       var submit = confirm("Are you sure you " +
                         "want to delete this slide?");
                       if (submit) {
                           b.splice(+e.target.dataset.count, 1);
                       }
                    };

                    // });
                }])
                .directive('slider', function () {
                    return {
                        restrict: 'A',
                        templateUrl: 'inputs.html',
                        scope: {
                            config: "="
                        },
                        controller: 'sliderCntl',
                        link: function (scope, elem, attr, ctrl) {
                            //console.log(ctrl)
                        }
                    }
                })
    </script>
</head>

<h2>Configure Slider Widget</h2>

<div ng-app="app">

    <form class="slider-form" ng-controller="sliderCntl" ng-submit="sendForm(formData)" name="configForm">

        <label><p><input name="color" type="radio" ng-model="formData.color" value="magenta">
            Set Magenta theme</p></label>

        <label><p><input name="color" type="radio" ng-model="formData.color" value="greenblue">
            Set Bluegreen theme</p></label>


        <button ng-click="addOne($event)">Add new slide</button>
        <div slider ng-repeat="config in formData.slides track by $index" config="config">

        </div>

        <p>
            <button class="submit-button" type="submit">Save changes</button>
        </p>
    </form>
</div>

</body>
</html>